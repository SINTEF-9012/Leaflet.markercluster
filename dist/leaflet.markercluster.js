/*
 Leaflet.markercluster, Provides Beautiful Animated Marker Clustering functionality for Leaflet, a JS library for interactive maps.
 https://github.com/Leaflet/Leaflet.markercluster
 (c) 2012-2013, Dave Leaver, smartrak
*/
!function(t,e){L.MarkerClusterGroup=L.FeatureGroup.extend({options:{maxClusterRadius:75,iconCreateFunction:null,spiderfyOnMaxZoom:!0,showCoverageOnHover:!0,zoomToBoundsOnClick:!0,singleMarkerMode:!1,disableClusteringAtZoom:null,removeOutsideVisibleBounds:!0,animateAddingMarkers:!1,spiderfyDistanceMultiplier:1,polygonOptions:{},automaticUpdate:!0},initialize:function(t){L.Util.setOptions(this,t),this.options.iconCreateFunction||(this.options.iconCreateFunction=this._defaultIconCreateFunction),this._featureGroup=L.featureGroup(),this._featureGroup.on(L.FeatureGroup.EVENTS,this._propagateEvent,this),this._nonPointGroup=L.featureGroup(),this._nonPointGroup.on(L.FeatureGroup.EVENTS,this._propagateEvent,this),this._inZoomAnimation=0,this._zoom=0,this._currentShownBounds=null,this._layers={},this._tree=null,this._displayedElements={},this._updateTask=this.options.automaticUpdate?0:1},addLayer:function(t){if(t instanceof L.LayerGroup)for(var e in t._layers)this.addLayer(t._layers[e]);else if(t.getLatLng){var i=L.stamp(t);this._layers[i]=t,this._callUpdateAndDisplay()}else this._nonPointGroup.addLayer(t);return this},removeLayer:function(t){if(t instanceof L.LayerGroup)for(var e in t._layers)this.removeLayer(t.layers[e]);else t.getLatLng||this._nonPointGroup.removeLayer(t);var i=L.stamp(t);return delete this._layers[i],this._featureGroup.hasLayer(t)&&(this._featureGroup.removeLayer(t),t.setOpacity&&t.setOpacity(1)),this._callUpdateAndDisplay(),this},addLayers:function(t){for(var e=0,i=t.length;i>e;e++)this.addLayer(t[e]);return this},removeLayers:function(t){for(var e=0,i=t.length;i>e;e++)this.removeLayer(t[e]);return this},clearLayers:function(){return this._layers={},this},getBounds:function(){var t=new L.LatLngBounds;return this._tree&&t.extend(this._tree.bounds),t.extend(this._nonPointGroup.getBounds()),t},eachLayer:function(t,e){for(var i=Object.keys(this._layers),n=0,s=i.length;s>n;++n)t.call(e,this._layers[i[n]]);this._nonPointGroup.eachLayer(t,e)},getLayers:function(){var t=[];return this.eachLayer(function(e){t.push(e)}),t},getLayer:function(t){return this._layers[t]||null},hasLayer:function(t){return t?this._layers.hasOwnProperty(L.stamp(t)):!1},update:function(){for(var t=[],e=Object.keys(this._layers),i=0,n=e.length;n>i;++i){var s=this._layers[e[i]];s._treePosition=s.getLatLng(),t.push(s)}this._tree=L.Tree.buildTree(t)},display:function(){this._unspiderfy&&this._unspiderfy();for(var t,e=Object.keys(this._displayedElements),i=0,n=e.length;n>i;++i)t=this._displayedElements[e[i]],this._map.removeLayer(t.display);if(this._displayedElements={},this._tree&&this._currentShownBounds){var s=this.options.disableClusteringAtZoom;if(s&&this._map.getZoom()>=s){console.log("ah");var o=this._tree.leafsInRange(this._currentShownBounds);for(console.log("bef"),i=0,n=o.length;n>i;++i){var r=o[i];this._displayedElements[L.stamp(r)]={display:r},this._map.addLayer(r)}}else{var a=this._treeWidthAndHeight(this._tree.bounds);this._recursivelyManageBosques(this._tree,this._currentShownBounds,a.width,a.height);var h=this.options.singleMarkerMode;for(e=Object.keys(this._displayedElements),i=0,n=e.length;n>i;++i)if(t=this._displayedElements[e[i]],1===t.count&&t.leaf&&!h)this._map.addLayer(t.leaf),t.display=t.leaf;else{var l=new L.MarkerCluster(this,t,this._tree);this._featureGroup.addLayer(l),t.display=l}}}},_callUpdateAndDisplay:function(){this._updateTask||(this._updateTask=t.setTimeout(L.bind(function(){this.update(),this.display(),this._updateTask=0},this),1))},_treeWidthAndHeight:function(t){var e=this._map.project(t.getSouthWest()),i=this._map.project(t.getNorthEast());return{width:i.x-e.x,height:e.y-i.y}},_addBosqueToScreen:function(t){var e=this._map.project(t.posAverage),i=this.options.maxClusterRadius,n=e.x-e.x%i,s=e.y-e.y%i,o=n+":"+s;if(this._displayedElements.hasOwnProperty(o)){console.log("hey ?");var r=this._displayedElements[o],a={bounds:new L.LatLngBounds,count:r.count+t.count,posAverage:new L.LatLng(r.posAverage.lat,r.posAverage.lng)};a.bounds.extend(r.bounds),a.bounds.extend(t.bounds),a.posAverage.lat=(r.posAverage.lat*r.count+t.posAverage.lat*t.count)/a.count,a.posAverage.lng=(r.posAverage.lng*r.count+t.posAverage.lng*t.count)/a.count,this._displayedElements[o]=a}else this._displayedElements[o]=t},_recursivelyManageBosques:function(t,e,i,n){if(null!==t){var s,o,r=Math.floor(.82*this.options.maxClusterRadius),a=!1,h=!1;if(null===t.left||t.left._treePosition||(s=this._treeWidthAndHeight(t.left.bounds),a=s.width>=r&&s.height>=r),null===t.right||t.right._treePosition||(o=this._treeWidthAndHeight(t.right.bounds),h=o.width>=r&&o.height>=r),a&&h)this._recursivelyManageBosques(t.left,e,s.width,s.height),this._recursivelyManageBosques(t.right,e,o.width,o.height);else{var l=Math.max(Math.round(i/(2*r)),1),u=Math.max(Math.round(n/(2*r)),1);if(l>1||u>1)for(var _=t.bounds._northEast.lng,d=t.bounds._southWest.lng,p=t.bounds._northEast.lat,c=t.bounds._southWest.lat,f=(_-d)/l,g=(p-c)/u,m=0;l>m;++m)for(var y=0;u>y;++y){var v=c+y*g,b=v+g,C=d+m*f,P=C+f;if(v>e._northEast.lat)break;if(C>e._northEast.lng)return;var A=new L.LatLngBounds;if(A.extend(new L.LatLng(v,C)),A.extend(new L.LatLng(b,P)),e.contains(A)||e.intersects(A)){var w=t.statsInRange(A);null!==w&&w.count>0&&this._addBosqueToScreen(w)}}else this._addBosqueToScreen(t.statsInRange(t.bounds))}}},zoomToShowLayer:function(t,e){t._icon&&this._map.getBounds().contains(t.getLatLng())?e():console.log("TODO")},onAdd:function(t){if(this._map=t,!isFinite(this._map.getMaxZoom()))throw"Map has no maxZoom specified";this._featureGroup.onAdd(t),this._nonPointGroup.onAdd(t),this._map.on("zoomend",this._zoomEnd,this),this._map.on("moveend",this._moveEnd,this),this._bindEvents(),this.update(),this._zoom=this._map.getZoom(),this._currentShownBounds=this._getExpandedVisibleBounds(),this.display()},onRemove:function(t){t.off("zoomend",this._zoomEnd,this),t.off("moveend",this._moveEnd,this),this._unbindEvents(),this._map._mapPane.className=this._map._mapPane.className.replace(" leaflet-cluster-anim",""),this._hideCoverage(),this._featureGroup.onRemove(t),this._nonPointGroup.onRemove(t),this._featureGroup.clearLayers(),this._map=null},getVisibleParent:function(){},_arraySplice:function(t,e){for(var i=t.length-1;i>=0;i--)if(t[i]===e)return t.splice(i,1),!0},_isOrIsParent:function(t,e){for(;e;){if(t===e)return!0;e=e.parentNode}return!1},_propagateEvent:function(t){if(t.layer instanceof L.MarkerCluster){if(t.originalEvent&&this._isOrIsParent(t.layer._icon,t.originalEvent.relatedTarget))return;t.type="cluster"+t.type}this.fire(t.type,t)},_defaultIconCreateFunction:function(t){var e=t.getChildCount(),i=" marker-cluster-";return i+=10>e?"small":100>e?"medium":"large",new L.DivIcon({html:"<div><span>"+e+"</span></div>",className:"marker-cluster"+i,iconSize:new L.Point(40,40)})},_bindEvents:function(){var t=this._map,e=this.options.spiderfyOnMaxZoom,i=this.options.showCoverageOnHover,n=this.options.zoomToBoundsOnClick;(e||n)&&this.on("clusterclick",this._zoomOrSpiderfy,this),i&&(this.on("clustermouseover",this._showCoverage,this),this.on("clustermouseout",this._hideCoverage,this),t.on("zoomend",this._hideCoverage,this))},_zoomOrSpiderfy:function(t){var e=this._map;e.getMaxZoom()===e.getZoom()?this.options.spiderfyOnMaxZoom&&t.layer.spiderfy():this.options.zoomToBoundsOnClick&&t.layer.zoomToBounds(),t.originalEvent&&13===t.originalEvent.keyCode&&e._container.focus()},_showCoverage:function(t){var e=this._map;this._inZoomAnimation||(this._shownPolygon&&e.removeLayer(this._shownPolygon),t.layer!==this._spiderfied&&(this._shownPolygon=new L.Polygon(t.layer.getConvexHull(),this.options.polygonOptions),e.addLayer(this._shownPolygon)))},_hideCoverage:function(){this._shownPolygon&&(this._map.removeLayer(this._shownPolygon),this._shownPolygon=null)},_unbindEvents:function(){var t=this.options.spiderfyOnMaxZoom,e=this.options.showCoverageOnHover,i=this.options.zoomToBoundsOnClick,n=this._map;(t||i)&&this.off("clusterclick",this._zoomOrSpiderfy,this),e&&(this.off("clustermouseover",this._showCoverage,this),this.off("clustermouseout",this._hideCoverage,this),n.off("zoomend",this._hideCoverage,this))},_zoomEnd:function(){this._map&&(this._zoom=this._map._zoom,this._currentShownBounds=this._getExpandedVisibleBounds(),this.display())},_moveEnd:function(){if(!this._inZoomAnimation){var t=this._getExpandedVisibleBounds();this._currentShownBounds=t,this.display()}},_enqueue:function(t){this._queue.push(t),this._queueTimeout||(this._queueTimeout=setTimeout(L.bind(this._processQueue,this),300))},_processQueue:function(){for(var t=0;t<this._queue.length;t++)this._queue[t].call(this);this._queue.length=0,clearTimeout(this._queueTimeout),this._queueTimeout=null},_getExpandedVisibleBounds:function(){if(!this.options.removeOutsideVisibleBounds)return this.getBounds();var t=this._map,e=t.getBounds(),i=e._southWest,n=e._northEast,s=L.Browser.mobile?0:Math.abs(i.lat-n.lat),o=L.Browser.mobile?0:Math.abs(i.lng-n.lng);return new L.LatLngBounds(new L.LatLng(i.lat-s,i.lng-o,!0),new L.LatLng(n.lat+s,n.lng+o,!0))}}),L.MarkerClusterGroup.include(L.DomUtil.TRANSITION?{_animationStart:function(){this._map._mapPane.className+=" leaflet-cluster-anim",this._inZoomAnimation++},_animationEnd:function(){this._map&&(this._map._mapPane.className=this._map._mapPane.className.replace(" leaflet-cluster-anim","")),this._inZoomAnimation--,this.fire("animationend")},_animationZoomIn:function(t,e){var i,n=this._getExpandedVisibleBounds(),s=this._featureGroup;this._topClusterLevel._recursively(n,t,0,function(o){var r,a=o._latlng,h=o._markers;for(n.contains(a)||(a=null),o._isSingleParent()&&t+1===e?(s.removeLayer(o),o._recursivelyAddChildrenToMap(null,e,n)):(o.setOpacity(0),o._recursivelyAddChildrenToMap(a,e,n)),i=h.length-1;i>=0;i--)r=h[i],n.contains(r._latlng)||s.removeLayer(r)}),this._forceLayout(),this._topClusterLevel._recursivelyBecomeVisible(n,e),s.eachLayer(function(t){t instanceof L.MarkerCluster||!t._icon||t.setOpacity(1)}),this._topClusterLevel._recursively(n,t,e,function(t){t._recursivelyRestoreChildPositions(e)}),this._enqueue(function(){this._topClusterLevel._recursively(n,t,0,function(t){s.removeLayer(t),t.setOpacity(1)}),this._animationEnd()})},_animationZoomOut:function(t,e){this._animationZoomOutSingle(this._topClusterLevel,t-1,e),this._topClusterLevel._recursivelyAddChildrenToMap(null,e,this._getExpandedVisibleBounds()),this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,t,this._getExpandedVisibleBounds())},_animationZoomOutSingle:function(t,e,i){var n=this._getExpandedVisibleBounds();t._recursivelyAnimateChildrenInAndAddSelfToMap(n,e+1,i);var s=this;this._forceLayout(),t._recursivelyBecomeVisible(n,i),this._enqueue(function(){if(1===t._childCount){var o=t._markers[0];o.setLatLng(o.getLatLng()),o.setOpacity&&o.setOpacity(1)}else t._recursively(n,i,0,function(t){t._recursivelyRemoveChildrenFromMap(n,e+1)});s._animationEnd()})},_animationAddLayer:function(t,e){var i=this,n=this._featureGroup;n.addLayer(t),e!==t&&(e._childCount>2?(e._updateIcon(),this._forceLayout(),this._animationStart(),t._setPos(this._map.latLngToLayerPoint(e.getLatLng())),t.setOpacity(0),this._enqueue(function(){n.removeLayer(t),t.setOpacity(1),i._animationEnd()})):(this._forceLayout(),i._animationStart(),i._animationZoomOutSingle(e,this._map.getMaxZoom(),this._map.getZoom())))},_forceLayout:function(){L.Util.falseFn(e.body.offsetWidth)}}:{_animationStart:function(){},_animationZoomIn:function(t,e){this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,t),this._topClusterLevel._recursivelyAddChildrenToMap(null,e,this._getExpandedVisibleBounds())},_animationZoomOut:function(t,e){this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,t),this._topClusterLevel._recursivelyAddChildrenToMap(null,e,this._getExpandedVisibleBounds())},_animationAddLayer:function(t,e){this._animationAddLayerNonAnimated(t,e)}}),L.markerClusterGroup=function(t){return new L.MarkerClusterGroup(t)},L.LatLngBounds.prototype.extend=function(t){var e,i,n=this._southWest,s=this._northEast;if(t instanceof L.LatLng)e=t,i=t;else{if(!(t instanceof L.LatLngBounds)){if(t){var o=L.latLng(t);if(null!==o)this.extend(o);else{var r=L.latLngBounds(t);null!==r&&this.extend(r)}return this}return this}if(e=t._southWest,i=t._northEast,!e||!i)return this}return n||s?(n.lat=Math.min(e.lat,n.lat),n.lng=Math.min(e.lng,n.lng),s.lat=Math.max(i.lat,s.lat),s.lng=Math.max(i.lng,s.lng)):(this._southWest=new L.LatLng(e.lat,e.lng),this._northEast=new L.LatLng(i.lat,i.lng)),this},L.MarkerCluster=L.Marker.extend({initialize:function(t,e,i){L.Marker.prototype.initialize.call(this,e.posAverage,{icon:this}),this._count=e.count,this._group=t,this._tree=e,this._root=i,this._iconNeedsUpdate=!0,this._bounds=e.bounds},getAllChildMarkers:function(){return this._root.leafsInRange(this._bounds)},getChildCount:function(){return this._count},zoomToBounds:function(){var t=this._group._map,e=t.getBoundsZoom(this._bounds),i=t.getZoom();i>=e?this._group._map.setView(this._latlng,i+1):this._group._map.fitBounds(this._bounds)},getBounds:function(){var t=new L.LatLngBounds;return t.extend(this._bounds),t},_updateIcon:function(){this._iconNeedsUpdate=!0,this._icon&&this.setIcon(this)},createIcon:function(){return this._iconNeedsUpdate&&(this._iconObj=this._group.options.iconCreateFunction(this),this._iconNeedsUpdate=!1),this._iconObj.createIcon()},createShadow:function(){return this._iconObj.createShadow()},_addChild:function(t,e){this._iconNeedsUpdate=!0,this._expandBounds(t),t instanceof L.MarkerCluster?(e||(this._childClusters.push(t),t.__parent=this),this._childCount+=t._childCount):(e||this._markers.push(t),this._childCount++),this.__parent&&this.__parent._addChild(t,!0)},_expandBounds:function(t){var e,i=t._wLatLng||t._latlng;t instanceof L.MarkerCluster?(this._bounds.extend(t._bounds),e=t._childCount):(this._bounds.extend(i),e=1),this._cLatLng||(this._cLatLng=t._cLatLng||i);var n=this._childCount+e;this._wLatLng?(this._wLatLng.lat=(i.lat*e+this._wLatLng.lat*this._childCount)/n,this._wLatLng.lng=(i.lng*e+this._wLatLng.lng*this._childCount)/n):this._latlng=this._wLatLng=new L.LatLng(i.lat,i.lng)},_addToMap:function(t){t&&(this._backupLatlng=this._latlng,this.setLatLng(t)),this._group._featureGroup.addLayer(this)},_recursivelyAnimateChildrenIn:function(t,e,i){this._recursively(t,0,i-1,function(t){var i,n,s=t._markers;for(i=s.length-1;i>=0;i--)n=s[i],n._icon&&(n._setPos(e),n.setOpacity(0))},function(t){var i,n,s=t._childClusters;for(i=s.length-1;i>=0;i--)n=s[i],n._icon&&(n._setPos(e),n.setOpacity(0))})},_recursivelyAnimateChildrenInAndAddSelfToMap:function(t,e,i){this._recursively(t,i,0,function(n){n._recursivelyAnimateChildrenIn(t,n._group._map.latLngToLayerPoint(n.getLatLng()).round(),e),n._isSingleParent()&&e-1===i?(n.setOpacity(1),n._recursivelyRemoveChildrenFromMap(t,e)):n.setOpacity(0),n._addToMap()})},_recursivelyBecomeVisible:function(t,e){this._recursively(t,0,e,null,function(t){t.setOpacity(1)})},_recursivelyAddChildrenToMap:function(t,e,i){this._recursively(i,-1,e,function(n){if(e!==n._zoom)for(var s=n._markers.length-1;s>=0;s--){var o=n._markers[s];i.contains(o._latlng)&&(t&&(o._backupLatlng=o.getLatLng(),o.setLatLng(t),o.setOpacity&&o.setOpacity(0)),n._group._featureGroup.addLayer(o))}},function(e){e._addToMap(t)})},_recursivelyRestoreChildPositions:function(t){for(var e=this._markers.length-1;e>=0;e--){var i=this._markers[e];i._backupLatlng&&(i.setLatLng(i._backupLatlng),delete i._backupLatlng)}if(t-1===this._zoom)for(var n=this._childClusters.length-1;n>=0;n--)this._childClusters[n]._restorePosition();else for(var s=this._childClusters.length-1;s>=0;s--)this._childClusters[s]._recursivelyRestoreChildPositions(t)},_restorePosition:function(){this._backupLatlng&&(this.setLatLng(this._backupLatlng),delete this._backupLatlng)},_recursivelyRemoveChildrenFromMap:function(t,e,i){var n,s;this._recursively(t,-1,e-1,function(t){for(s=t._markers.length-1;s>=0;s--)n=t._markers[s],i&&i.contains(n._latlng)||(t._group._featureGroup.removeLayer(n),n.setOpacity&&n.setOpacity(1))},function(t){for(s=t._childClusters.length-1;s>=0;s--)n=t._childClusters[s],i&&i.contains(n._latlng)||(t._group._featureGroup.removeLayer(n),n.setOpacity&&n.setOpacity(1))})},_recursively:function(t,e,i,n,s){var o,r,a=this._childClusters,h=this._zoom;if(e>h)for(o=a.length-1;o>=0;o--)r=a[o],t.intersects(r._bounds)&&r._recursively(t,e,i,n,s);else if(n&&n(this),s&&this._zoom===i&&s(this),i>h)for(o=a.length-1;o>=0;o--)r=a[o],t.intersects(r._bounds)&&r._recursively(t,e,i,n,s)},_recalculateBounds:function(){var t,e=this._markers,i=this._childClusters;for(this._bounds=new L.LatLngBounds,delete this._wLatLng,t=e.length-1;t>=0;t--)this._expandBounds(e[t]);for(t=i.length-1;t>=0;t--)this._expandBounds(i[t])},_isSingleParent:function(){return this._childClusters.length>0&&this._childClusters[0]._childCount===this._childCount}}),L.Tree=function(t){this.left=null,this.right=null,this.count=0,this.dimension=t,this.bounds=null,this.posAverage=new L.LatLng(0,0)},L.Tree.prototype={updateInformations:function(){this.count=0,this.posAverage.lat=0,this.posAverage.lng=0,this.bounds=new L.LatLngBounds,null!==this.left&&(this.left._treePosition?L.Tree._applyInformations(this,1,this.left._treePosition,this.left._treePosition):L.Tree._applyInformations(this,this.left.count,this.left.posAverage,this.left.bounds)),null!==this.right&&(this.right._treePosition?L.Tree._applyInformations(this,1,this.right._treePosition,this.right._treePosition):L.Tree._applyInformations(this,this.right.count,this.right.posAverage,this.right.bounds))},allLeafs:function(t){t=t||[],null!==this.left&&(this.left._treePosition?t.push(this.left):this.left.allLeafs(t)),null!==this.right&&(this.right._treePosition?t.push(this.right):this.right.allLeafs(t))},leafsInRange:function(t,e){return e=e||[],t.contains(this.bounds)?this.allLeafs(e):t.intersects(this.bounds)&&(null!==this.left&&(this.left._treePosition?t.contains(this.left._treePosition)&&e.push(this.left):this.left.leafsInRange(t,e)),null!==this.right&&(this.right._treePosition?t.contains(this.right._treePosition)&&e.push(this.right):this.right.leafsInRange(t,e))),e},statsInRange:function(t){var e;if(t.contains(this.bounds))return e={count:this.count,bounds:new L.LatLngBounds,posAverage:new L.LatLng(this.posAverage.lat,this.posAverage.lng)},1===this.count&&(null!==this.left&&this.left._treePosition?e.leaf=this.left:null!==this.right&&this.right._treePosition&&(e.leaf=this.right)),e.bounds.extend(this.bounds),e;if(t.intersects(this.bounds)){e={count:0,bounds:new L.LatLngBounds,posAverage:new L.LatLng(0,0)};var i=null;if(null!==this.left)if(this.left._treePosition)t.contains(this.left._treePosition)&&(L.Tree._applyInformations(e,1,this.left._treePosition,this.left._treePosition),i=this.left);else{var n=this.left.statsInRange(t);null!==n&&n.count>0&&(L.Tree._applyInformations(e,n.count,n.posAverage,n.bounds),n.leaf&&(i=n.leaf))}if(null!==this.right)if(this.right._treePosition)t.contains(this.right._treePosition)&&(L.Tree._applyInformations(e,1,this.right._treePosition,this.right._treePosition),i=this.right);else{var s=this.right.statsInRange(t);null!==s&&s.count>0&&(L.Tree._applyInformations(e,s.count,s.posAverage,s.bounds),s.leaf&&(i=s.leaf))}return 1===e.count&&(e.leaf=i),e}return null}},L.Tree.buildTree=function(t,e){var i=t.length;if(0===i)return null;e=(0|e)%2,t.sort(L.Tree._compareMethods[e]);var n=Math.floor(i/2),s=new L.Tree(e);return s.left=n>0?n>1?L.Tree.buildTree(t.slice(0,n),e+1):t[0]:null,s.right=i-n===1?t[n]:L.Tree.buildTree(t.slice(n),e+1),s.updateInformations(),s},L.Tree._compareMethods=[function(t,e){var i=t._treePosition.lat,n=e._treePosition.lat;return 0|(i>n?1:n>i?-1:0)},function(t,e){var i=t._treePosition.lng,n=e._treePosition.lng;return 0|(i>n?1:n>i?-1:0)}],L.Tree._applyInformations=function(t,e,i,n){var s=t.count;t.count+=e,t.count>0&&(t.posAverage.lat=(t.posAverage.lat*s+i.lat*e)/t.count,t.posAverage.lng=(t.posAverage.lng*s+i.lng*e)/t.count),t.bounds||(t.bounds=new L.LatLngBounds),t.bounds.extend(n)},function(){L.QuickHull={getDistant:function(t,e){var i=e[1].lat-e[0].lat,n=e[0].lng-e[1].lng;return n*(t.lat-e[0].lat)+i*(t.lng-e[0].lng)},findMostDistantPointFromBaseLine:function(t,e){var i,n,s,o=0,r=null,a=[];for(i=e.length-1;i>=0;i--)n=e[i],s=this.getDistant(n,t),s>0&&(a.push(n),s>o&&(o=s,r=n));return{maxPoint:r,newPoints:a}},buildConvexHull:function(t,e){var i=[],n=this.findMostDistantPointFromBaseLine(t,e);return n.maxPoint?(i=i.concat(this.buildConvexHull([t[0],n.maxPoint],n.newPoints)),i=i.concat(this.buildConvexHull([n.maxPoint,t[1]],n.newPoints))):[t[0]]},getConvexHull:function(t){var e,i=!1,n=!1,s=null,o=null;for(e=t.length-1;e>=0;e--){var r=t[e];(i===!1||r.lat>i)&&(s=r,i=r.lat),(n===!1||r.lat<n)&&(o=r,n=r.lat)}var a=[].concat(this.buildConvexHull([o,s],t),this.buildConvexHull([s,o],t));return a}}}(),L.MarkerCluster.include({getConvexHull:function(){var t,e,i=this.getAllChildMarkers(),n=[];for(e=i.length-1;e>=0;e--)t=i[e].getLatLng(),n.push(t);return L.QuickHull.getConvexHull(n)}}),L.MarkerCluster.include({_2PI:2*Math.PI,_circleFootSeparation:25,_circleStartAngle:Math.PI/6,_spiralFootSeparation:28,_spiralLengthStart:11,_spiralLengthFactor:5,_circleSpiralSwitchover:9,spiderfy:function(){if(this._group._spiderfied!==this&&!this._group._inZoomAnimation){var t,e=this.getAllChildMarkers(),i=this._group,n=i._map,s=n.latLngToLayerPoint(this._latlng);this._group._unspiderfy(),this._group._spiderfied=this,e.length>=this._circleSpiralSwitchover?t=this._generatePointsSpiral(e.length,s):(s.y+=10,t=this._generatePointsCircle(e.length,s)),this._animationSpiderfy(e,t)}},unspiderfy:function(t){this._group._inZoomAnimation||(this._animationUnspiderfy(t),this._group._spiderfied=null)},_generatePointsCircle:function(t,e){var i,n,s=this._group.options.spiderfyDistanceMultiplier*this._circleFootSeparation*(2+t),o=s/this._2PI,r=this._2PI/t,a=[];for(a.length=t,i=t-1;i>=0;i--)n=this._circleStartAngle+i*r,a[i]=new L.Point(e.x+o*Math.cos(n),e.y+o*Math.sin(n))._round();return a},_generatePointsSpiral:function(t,e){var i,n=this._group.options.spiderfyDistanceMultiplier*this._spiralLengthStart,s=this._group.options.spiderfyDistanceMultiplier*this._spiralFootSeparation,o=this._group.options.spiderfyDistanceMultiplier*this._spiralLengthFactor,r=0,a=[];for(a.length=t,i=t-1;i>=0;i--)r+=s/n+5e-4*i,a[i]=new L.Point(e.x+n*Math.cos(r),e.y+n*Math.sin(r))._round(),n+=this._2PI*o/r;return a},_noanimationUnspiderfy:function(){var t,e,i=this._group,n=i._map,s=i._featureGroup,o=this.getAllChildMarkers();for(this.setOpacity(1),e=o.length-1;e>=0;e--)t=o[e],s.removeLayer(t),t._preSpiderfyLatlng&&(t.setLatLng(t._preSpiderfyLatlng),delete t._preSpiderfyLatlng),t.setZIndexOffset&&t.setZIndexOffset(0),t._spiderLeg&&(n.removeLayer(t._spiderLeg),delete t._spiderLeg);i._spiderfied=null}}),L.MarkerCluster.include(L.DomUtil.TRANSITION?{SVG_ANIMATION:function(){return e.createElementNS("http://www.w3.org/2000/svg","animate").toString().indexOf("SVGAnimate")>-1}(),_animationSpiderfy:function(t,i){var n,s,o,r,a=this,h=this._group,l=h._map,u=h._featureGroup,_=l.latLngToLayerPoint(this._latlng);for(n=t.length-1;n>=0;n--)s=t[n],s.setOpacity?(s.setZIndexOffset(1e6),s.setOpacity(0),u.addLayer(s),s._setPos(_)):u.addLayer(s);h._forceLayout(),h._animationStart();var d=L.Path.SVG?0:.3,p=L.Path.SVG_NS;for(n=t.length-1;n>=0;n--)if(r=l.layerPointToLatLng(i[n]),s=t[n],s._preSpiderfyLatlng=s._latlng,s.setLatLng(r),s.setOpacity&&s.setOpacity(1),o=new L.Polyline([a._latlng,r],{weight:1.5,color:"#222",opacity:d}),l.addLayer(o),s._spiderLeg=o,L.Path.SVG&&this.SVG_ANIMATION){var c=o._path.getTotalLength();o._path.setAttribute("stroke-dasharray",c+","+c);var f=e.createElementNS(p,"animate");f.setAttribute("attributeName","stroke-dashoffset"),f.setAttribute("begin","indefinite"),f.setAttribute("from",c),f.setAttribute("to",0),f.setAttribute("dur",.25),o._path.appendChild(f),f.beginElement(),f=e.createElementNS(p,"animate"),f.setAttribute("attributeName","stroke-opacity"),f.setAttribute("attributeName","stroke-opacity"),f.setAttribute("begin","indefinite"),f.setAttribute("from",0),f.setAttribute("to",.5),f.setAttribute("dur",.25),o._path.appendChild(f),f.beginElement()}if(a.setOpacity(.3),L.Path.SVG)for(this._group._forceLayout(),n=t.length-1;n>=0;n--)s=t[n]._spiderLeg,s.options.opacity=.5,s._path.setAttribute("stroke-opacity",.5);setTimeout(function(){h._animationEnd(),h.fire("spiderfied")},200)},_animationUnspiderfy:function(t){var e,i,n,s=this._group,o=s._map,r=s._featureGroup,a=t?o._latLngToNewLayerPoint(this._latlng,t.zoom,t.center):o.latLngToLayerPoint(this._latlng),h=this.getAllChildMarkers(),l=L.Path.SVG&&this.SVG_ANIMATION;for(s._animationStart(),this.setOpacity(1),i=h.length-1;i>=0;i--)e=h[i],e._preSpiderfyLatlng&&(e.setLatLng(e._preSpiderfyLatlng),delete e._preSpiderfyLatlng,e.setOpacity?(e._setPos(a),e.setOpacity(0)):r.removeLayer(e),l&&(n=e._spiderLeg._path.childNodes[0],n.setAttribute("to",n.getAttribute("from")),n.setAttribute("from",0),n.beginElement(),n=e._spiderLeg._path.childNodes[1],n.setAttribute("from",.5),n.setAttribute("to",0),n.setAttribute("stroke-opacity",0),n.beginElement(),e._spiderLeg._path.setAttribute("stroke-opacity",0)));setTimeout(function(){var t=0;for(i=h.length-1;i>=0;i--)e=h[i],e._spiderLeg&&t++;for(i=h.length-1;i>=0;i--)e=h[i],e._spiderLeg&&(e.setOpacity&&(e.setOpacity(1),e.setZIndexOffset(0)),t>1&&r.removeLayer(e),o.removeLayer(e._spiderLeg),delete e._spiderLeg);s._animationEnd()},200)}}:{_animationSpiderfy:function(t,e){var i,n,s,o,r=this._group,a=r._map,h=r._featureGroup;for(i=t.length-1;i>=0;i--)o=a.layerPointToLatLng(e[i]),n=t[i],n._preSpiderfyLatlng=n._latlng,n.setLatLng(o),n.setZIndexOffset&&n.setZIndexOffset(1e6),h.addLayer(n),s=new L.Polyline([this._latlng,o],{weight:1.5,color:"#222"}),a.addLayer(s),n._spiderLeg=s;this.setOpacity(.3),r.fire("spiderfied")},_animationUnspiderfy:function(){this._noanimationUnspiderfy()}}),L.MarkerClusterGroup.include({_spiderfied:null,_spiderfierOnAdd:function(){this._map.on("click",this._unspiderfyWrapper,this),this._map.options.zoomAnimation&&this._map.on("zoomstart",this._unspiderfyZoomStart,this),this._map.on("zoomend",this._noanimationUnspiderfy,this),L.Path.SVG&&!L.Browser.touch&&this._map._initPathRoot()},_spiderfierOnRemove:function(){this._map.off("click",this._unspiderfyWrapper,this),this._map.off("zoomstart",this._unspiderfyZoomStart,this),this._map.off("zoomanim",this._unspiderfyZoomAnim,this),this._unspiderfy()},_unspiderfyZoomStart:function(){this._map&&this._map.on("zoomanim",this._unspiderfyZoomAnim,this)},_unspiderfyZoomAnim:function(t){L.DomUtil.hasClass(this._map._mapPane,"leaflet-touching")||(this._map.off("zoomanim",this._unspiderfyZoomAnim,this),this._unspiderfy(t))},_unspiderfyWrapper:function(){this._unspiderfy()},_unspiderfy:function(t){this._spiderfied&&this._spiderfied.unspiderfy(t)},_noanimationUnspiderfy:function(){this._spiderfied&&this._spiderfied._noanimationUnspiderfy()},_unspiderfyLayer:function(t){t._spiderLeg&&(this._featureGroup.removeLayer(t),t.setOpacity(1),t.setZIndexOffset(0),this._map.removeLayer(t._spiderLeg),delete t._spiderLeg)}})}(window,document);